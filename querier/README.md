Rodrigo Vega Ayllon reva5

Implemented all subsets of functionality.

Note: I acknowledge that, on the test case with valgrind, there is a memory error that says: "Invalid [read/write] of size x".
